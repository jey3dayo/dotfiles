# ========================================
# グローバル mise 設定（ツール・共通設定のみ）
# ~/.config/mise/config.toml
# ========================================

[settings]
env_file = '.env.local'
experimental = true
jobs = 8                                                            # デフォルトの並列実行数
vfox = false
idiomatic_version_file_enable_tools = ["go"]
trusted_config_paths = ["~/src/github.com", "/private/var/folders"]

[settings.pipx]
uvx = true

[env]
_.source = [".venv/bin/activate"]
YAMLLINT_CONFIG_FILE = "yamllint/config"
MD_GLOB = "**/*.md"
MD_EXCLUDES = "#node_modules #tmux/plugins #fisher #zsh/.zinit"

# ========================================
# オプション環境変数（ファイル限定処理）
# ========================================
# フォーマット/lint タスクで特定ファイルのみ処理する場合に設定
# 例: SH_FILES="script1.sh script2.sh" mise run format:shell
#
# SH_FILES = ""      # シェルスクリプト
# PY_FILES = ""      # Python ファイル
# LUA_FILES = ""     # Lua ファイル
# TOML_FILES = ""    # TOML ファイル
# BIOME_FILES = ""   # JS/TS/JSON ファイル (biome)
# PRETTIER_FILES = "" # Prettier 対象ファイル
# YAML_FILES = ""    # YAML ファイル

# ========================================
# ツール定義 (Tools)
# ========================================
# mise で管理する全ツールを定義
# カテゴリ: 1) Runtimes, 2) Package Managers, 3) Formatters/Linters,
#          4) NPM Packages, 5) Cargo Tools, 6) CLI Tools

[tools]
# ========================================
# 1. Language Runtimes (言語ランタイム - 開発用)
# ========================================
# 注: システム依存関係用の Node.js/Python は Homebrew で管理
go = "1.25.5"                    # Go ランタイム
node = "24"                      # Node.js ランタイム (開発用)
python = "3.14"                  # Python ランタイム (開発用)
# FIXME: Temporarily disabled due to luarocks 3.13.0 rockspec parsing issues in CI
# lua = "5.1.5"                  # LuaRocks/Neovim 互換版 (Homebrew で管理推奨)
# luajit = "latest"              # LuaJIT (Homebrew で管理推奨)

# ========================================
# 2. Package Managers (パッケージマネージャー)
# ========================================
"pipx:uv" = "latest"             # Python: 高速パッケージマネージャー
bun = "latest"                   # JavaScript ランタイム + パッケージマネージャー

# FIXME: Temporarily disabled due to CI failures - revisit when stable
# "pipx:git+https://github.com/agentskills/agentskills.git" = "main#subdirectory=skills-ref"

# ========================================
# 3. Formatters and Linters (フォーマッター・Linter - 統一管理)
# ========================================
actionlint = "latest"            # GitHub Actions ワークフロー Linter
biome = "latest"                 # JavaScript/TypeScript/JSON フォーマッター + Linter
prettier = "latest"              # マルチ言語対応フォーマッター
# 注: hadolint は macOS/Linux x86_64 のみ (プラットフォーム固有セクション参照)
shellcheck = "latest"            # Shell スクリプト Linter
shfmt = "latest"                 # Shell スクリプト フォーマッター
stylua = "latest"                # Lua フォーマッター
taplo = "latest"                 # TOML フォーマッター + Linter
yamllint = "latest"              # YAML Linter

# ========================================
# 4. NPM Global Packages (Node.js グローバルパッケージ)
# ========================================

# ユーティリティ・ツール
"npm:@antfu/ni" = "latest"       # 統一パッケージマネージャーインターフェース
"npm:corepack" = "latest"        # 複数のパッケージマネージャー管理
"npm:husky" = "latest"           # Git hooks フレームワーク
"npm:npm" = "latest"             # npm 本体
"npm:npm-check-updates" = "latest"  # npm 依存関係の更新チェック

# 開発・エディタ
"npm:@fsouza/prettierd" = "latest"  # Prettier デーモン (エディタ統合)
"npm:neovim" = "latest"          # Neovim Node.js クライアント

# プロトコルバッファ・RPC
"npm:@bufbuild/protoc-gen-es" = "latest"  # Protobuf: ECMAScript コード生成
"npm:@connectrpc/protoc-gen-connect-es" = "latest"  # Connect: ECMAScript RPC コード生成

# AI・コミット支援
"npm:@openai/codex" = "latest"   # OpenAI Codex SDK
"npm:aicommits" = "latest"       # AI による自動コミットメッセージ生成

# ドキュメント・Lint
"npm:markdown-link-check" = "latest"  # Markdown リンク検証
"npm:markdownlint-cli2" = "latest"    # Markdown Linter
"npm:textlint" = "latest"        # 日本語テキスト Linter
"npm:textlint-rule-preset-ja-technical-writing" = "latest"  # 日本語技術文章ルール

# 環境変数管理
"npm:@dotenvx/dotenvx" = "latest"  # .env ファイル管理・暗号化

# 開発ツール・Language Servers
"npm:eslint_d" = "latest"         # ESLint デーモン (エディタ統合)
"npm:typescript" = "latest"       # TypeScript コンパイラ
"npm:typescript-language-server" = "latest"  # TypeScript LSP
"npm:vscode-json-languageserver" = "latest"  # JSON LSP
"npm:vscode-langservers-extracted" = "latest"  # HTML/CSS/JSON/ESLint LSP
"npm:@typescript-eslint/eslint-plugin" = "latest"  # TypeScript ESLint プラグイン

# ビルドツール
"npm:esbuild" = "latest"          # 高速 JavaScript/TypeScript バンドラー

# ユーティリティ
"npm:zx" = "latest"               # JavaScript シェルスクリプト

# MCP サーバー (Model Context Protocol)
"npm:@aikidosec/safe-chain" = "latest"  # MCP: セキュリティチェーン
"npm:@benborla29/mcp-server-mysql" = "latest"  # MCP: MySQL サーバー
"npm:@modelcontextprotocol/server-filesystem" = "latest"  # MCP: ファイルシステム
"npm:@playwright/mcp" = "latest"  # MCP: Playwright 統合
"npm:@upstash/context7-mcp" = "latest"  # MCP: Context7 統合
"npm:chrome-devtools-mcp" = "latest"  # MCP: Chrome DevTools
"npm:exa-mcp-server" = "latest"   # MCP: Exa サーバー
"npm:o3-search-mcp" = "latest"    # MCP: O3 検索

# Claude/AI ツール
"npm:@anthropic-ai/dxt" = "latest"  # Anthropic DXT ツール
"npm:@mariozechner/claude-bridge" = "latest"  # Claude ブリッジ
"npm:@sasazame/ccresume" = "latest"  # Claude Code Resume
"npm:ccusage" = "latest"          # Claude Code 使用状況トラッカー
"npm:dev3000" = "latest"          # 開発サーバー

# クラウド・インフラ
"npm:aws-cdk" = "latest"          # AWS CDK
"npm:@google/clasp" = "latest"    # Google Apps Script CLI
"npm:@google/gemini-cli" = "latest"  # Google Gemini CLI

# その他ツール
"npm:greptile" = "latest"         # コード検索ツール
"npm:difit" = "latest"            # ディフィットツール
"npm:tuyapi" = "latest"           # Tuya API クライアント

# ========================================
# 5. Cargo-based Tools (WSL2専用含む)
# ========================================
# 注: bat, ripgrep, eza, hexyl, zoxide, typos-lsp は Homebrew で管理
"cargo:bandwhich" = "latest"
"cargo:needle-cli" = "latest"
"cargo:similarity-ts" = "latest"
"cargo:wrkflw" = "latest"

# ========================================
# 6. CLI Tools (コマンドラインユーティリティ)
# ========================================
aws-cli = "latest"
eza = "latest"
fd = "latest"
"github:cli/cli" = "latest"
jq = "latest"
opencode = "latest"
yazi = "latest"

# ========================================
# タスク設定 (Task Configuration)
# ========================================
# タスク定義は mise/tasks/ ディレクトリに分割されています。
# .mise.toml の [task_config] セクションで読み込まれます。
