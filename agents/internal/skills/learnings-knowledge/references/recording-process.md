# Recording Process - 3段階記録プロセス詳細

## 概要

知見記録は緊急度と重要度に応じて3段階のプロセスに分類されます。各段階は記録タイミング、判断基準、記録方法が明確に定義されており、効率的な知見管理を実現します。

---

## 🔴🟠 Stage 1: 緊急・重要知見の即時記録

### 優先度

### 最高優先度

### 対象となる知見

1. 障害対応・インシデント対応
   - システムダウン、データ損失、重大なバグの修正
   - ユーザー影響が大きい問題の解決策
   - 本番環境での緊急対応

2. アーキテクチャ決定・設計パターン
   - システム全体に影響する設計決定
   - 技術スタックの選定理由
   - マイクロサービス分割戦略
   - レイヤードアーキテクチャの実装

3. セキュリティ脆弱性・対策
   - XSS / CSRF / SQL Injection 対策
   - 認証・認可の脆弱性修正
   - データ漏洩リスクの対応

4. パフォーマンス最適化（重大な改善）
   - 10倍以上の速度改善
   - メモリリークの修正
   - 重いクエリの最適化

### 記録タイミング

- 問題解決直後（記憶が鮮明なうち）
- インシデント対応後のポストモーテム
- アーキテクチャレビュー後
- セキュリティ監査後

### 記録方法

```bash
# 障害対応
/learnings arch "障害対応: Redis接続プールの枯渇問題 → 接続プール設定を10→50に増加し、接続タイムアウトを3秒に設定"

# セキュリティ対策
/learnings sec "XSS脆弱性修正: ユーザー入力をDOMPurifyでサニタイズし、Content-Security-Policyヘッダーを追加"

# パフォーマンス最適化
/learnings perf "N+1問題解決: 100回のクエリをJOINで1回に集約し、レスポンス時間を5秒→0.5秒に改善"
```

### 記録内容の要件

- **問題の背景**: 何が起きたか、どのような影響があったか
- **根本原因**: 技術的な原因と発生メカニズム
- **解決策**: 具体的な修正内容とコード例
- **定量的効果**: レスポンス時間、エラー率、パフォーマンス指標
- **再発防止策**: 同様の問題を防ぐための仕組み

### 定量的目標

- 記録率: 100%（すべての重大問題を記録）
- 記録時間: 問題解決後24時間以内
- 詳細度: 他のチームメンバーが再現できるレベル

---

## 🟡 Stage 2: 開発効率向上知見

### 優先度

### 高優先度

### 対象となる知見

1. テスト戦略・テストパターン
   - 効果的なユニットテストの設計
   - 統合テストのモック戦略
   - E2Eテストの自動化手法

2. デバッグ手法・トラブルシューティング
   - 効率的なデバッグフロー
   - ログ分析手法
   - プロファイリングツールの活用

3. 開発ワークフロー改善
   - CI/CDパイプラインの最適化
   - コードレビュープロセスの改善
   - ブランチ戦略の見直し

4. リンター・コード品質
   - 頻出するリンターエラーの修正パターン
   - 型エラーの解決手法
   - コード規約の適用事例

### 記録タイミング

- スプリント終了時のレトロスペクティブ
- 週次のチームミーティング
- 同じ問題が2回以上発生した時
- 効率化に成功した時点

### 記録方法

```bash
# テスト戦略
/learnings test "AAA パターン: Arrange-Act-Assert で統合テストを構造化 → テストの可読性80%向上"

# デバッグ手法
/learnings fix "React DevTools: Profiler タブで不要な再レンダリングを特定 → useCallback/useMemoで最適化"

# CI/CD最適化
/learnings test "並列テスト: Jestのmaxworkers=4で実行時間5分→2分に短縮"
```

### 記録内容の要件

- **課題**: 何が非効率だったか
- **改善策**: 具体的な改善手順
- **効果**: 時間短縮、エラー削減の定量データ
- **適用条件**: どのような状況で使えるか

### 定量的目標

- 記録率: 80%（主要な改善事例を記録）
- 記録時間: 改善実施後1週間以内
- 詳細度: 他のチームメンバーが同じ改善を再現できる

---

## 🟢 Stage 3: 実装パターン・ベストプラクティス

### 優先度

### 通常優先度

### 対象となる知見

1. コード品質・設計パターン
   - SOLID原則の適用
   - デザインパターンの実装例
   - リファクタリング手法

2. UIコンポーネント設計
   - 再利用可能なコンポーネント設計
   - アクセシビリティ対応
   - レスポンシブデザインパターン

3. データベース設計
   - スキーマ設計のベストプラクティス
   - インデックス戦略
   - マイグレーション手法

4. 実装小技・Tips
   - 便利なライブラリの使い方
   - 効率的なコーディングテクニック
   - ショートカット・ツール活用

### 記録タイミング

- 月次のナレッジシェアリング
- 新人オンボーディング時
- ドキュメント整理のタイミング
- コードレビューで良い実装を見つけた時

### 記録方法

```bash
# 設計パターン
/learnings arch "Repository パターン: データアクセスロジックをビジネスロジックから分離 → テスト可能性向上"

# UIコンポーネント
/learnings ui "Compound Component: 親子コンポーネントで状態を共有 → 柔軟な構成が可能"

# データベース設計
/learnings db "複合インデックス: (user_id, created_at) でクエリ速度10倍改善"
```

### 記録内容の要件

- **パターン名**: 認識しやすい名称
- **適用場面**: どのような状況で使うか
- **実装例**: コードスニペット
- **メリット・デメリット**: トレードオフの説明

### 定量的目標

- 記録率: 50%（特に有用なパターンを厳選）
- 記録時間: 四半期末までに整理
- 詳細度: ドキュメントとして参照できるレベル

---

## 記録プロセスの判断フロー

```
知見を得た
    ↓
Q: システムに重大な影響があるか？
    ↓ YES → 🔴🟠 Stage 1: 即座に記録
    ↓ NO
    ↓
Q: 開発効率を大きく改善するか？
    ↓ YES → 🟡 Stage 2: 1週間以内に記録
    ↓ NO
    ↓
Q: 再利用可能なパターンか？
    ↓ YES → 🟢 Stage 3: 月次でまとめて記録
    ↓ NO
    ↓
記録不要（一時的な対応）
```

---

## 記録品質の基準

### 最低限の記録内容

1. タイトル: 20-40文字で内容を要約
2. 背景: なぜこの知見が必要だったか
3. 解決策: 具体的な実装方法
4. 効果: 定量的または定性的な改善

### 推奨される記録内容

1. コード例: スニペットまたはGistリンク
2. 関連資料: ドキュメント、記事、PR番号
3. 適用条件: どのような状況で使えるか
4. 注意点: 落とし穴、トレードオフ

---

## 記録頻度の目安

| 段階         | 頻度 | 月間記録数 | 累計目標     |
| ------------ | ---- | ---------- | ------------ |
| 🔴🟠 Stage 1 | 即座 | 2-5件      | 年間30-60件  |
| 🟡 Stage 2   | 週次 | 4-8件      | 年間50-100件 |
| 🟢 Stage 3   | 月次 | 5-10件     | 年間60-120件 |

### 合計目標

---

## 記録効率化のTips

### 1. テンプレート活用

```markdown
## [カテゴリ] タイトル

**背景**: 何が課題だったか
**解決策**: どう対応したか
**効果**: どれくらい改善したか
**コード**: スニペットまたはリンク
```

### 2. 即座にメモ、後で整形

- 問題解決直後に箇条書きでメモ
- 週次レビューで詳細化

### 3. ペアプログラミング・コードレビューで記録

- 優れた実装を見つけたら即座に記録
- レビュアーがベストプラクティスを記録

---

## 関連リファレンス

- **カテゴリ詳細**: `learning-categories.md`
- **活用パターン**: `usage-patterns.md`
- **記録例**: `examples/learning-records.md`
