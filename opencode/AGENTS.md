# Claude AI 開発協働ガイド

## 言語

内部で英語思考を行ってもよいが、最終的な回答・説明は必ず日本語で提供する

## プロジェクトコンテキスト

プロジェクトに `.kiro/steering/` がある場合は読み込んで参照すること。

## 協働の原則

### 相互尊重と透明性

- ユーザーの時間と判断を尊重し、自分の能力を信じて最善を尽くす
- 分からないことは素直に「分からない」と言い、思考プロセスをオープンにする

### 責任感と品質保証

- 大規模変更時は事前計画共有で承認を得る
- 品質保証（lint/test/build）は必ず実行
- 既存テストなど重要なものは勝手に削除しない

### コミュニケーション

- 作業完了時は適切に報告、問題や疑問があれば遠慮なく相談
- ユーザーからのフィードバックを真摯に受け止め、深い思考で本質的な洞察を目指す
- 計画提示時: 事前承認確認
- 不確実性発見時: 素直に「分からない」と報告
- 問題発生時: 早期相談・透明な情報共有

### ファイル操作の原則

- 要求されたことだけを実行: 余計な作業や追加機能を勝手に実装しない
- 既存ファイル優先: 新規ファイル作成は必要最小限に留め、既存ファイルの編集を優先
- ドキュメント作成制限: README.mdや\*.mdファイルは明示的に要求された場合のみ作成

## タスク実行の原則

### タスク細分化（TaskCreate/TaskList/TaskUpdate活用）

- 3ステップ以上の複雑な作業: TaskCreateでタスクを作成し進捗を可視化
- 独立したタスク: 並列実行を検討（Task tool + サブエージェント）
- 作業開始時: TaskUpdateでステータスをin_progressに更新
- 完了時: TaskUpdateでステータスをcompletedに更新
- 単純なタスク: タスク作成は不要、直接実行

## 品質保証

### テスト戦略

- 静的解析（基盤）: 型システム厳格設定、動的型排除
- 統合テスト（メイン）: ユーザー操作シナリオ、AAA パターン厳守
- ユニット/E2E テスト（最小限）: 純粋関数・重要フローのみ

### 品質保証実行

- 必須: テスト実行、型チェック、リンター、フォーマッター
- 完了時チェック: 型エラー 0 件 / リント違反 0 件 / 全テスト成功 / 既存機能動作確認

### 開発原則

- 型安全性: 型アサーション排除、any 型排除
- エラーハンドリング: 適切なエラー処理パターンの実装
- バリデーション: 入力値の適切な検証

## 実装ワークフロー

### 基本フロー

1. 計画承認 → 大規模変更時は事前に変更概要を共有
2. コード理解 → 下記ツール優先順で効率的に探索
3. 型安全実装 → 影響範囲確認・テスト実装
4. 品質保証 → lint/test/build実行・完了報告

### ツール選択の原則

**コード理解ツール優先順位**（トークン効率重視）:

1. grepai (`mcp__grepai__*`) - セマンティック検索・コールグラフ解析
2. MCP Serena (`mcp__serena__*`) - 関数・クラス・シンボル解析
3. Grep/ripgrep - パターン検索・横断的調査
4. Read - 設定ファイル・小規模ファイル・最終手段

**最新情報取得**:

- o3-search (`mcp__o3__o3-search`) - 複雑なエラー、技術的疑問、ライブラリ使用方法の最新情報取得

**禁止**: `find`, `grep`, `cat`, `head`, `tail` → 上記専用ツールを使用

### 未使用変数の取り扱い

- 原則: 未使用変数は削除またはリファクタリングで対応
- 例外的に`_`プレフィックス許可（真に避けられない制約のみ）:
  - エラーハンドリング: `_error`, `_err` (catch 文など)
  - フレームワーク制約: 必須引数で使用しない場合
  - 関数引数: `_param`など

## ドキュメント作成の原則

### 優先順位（高→低）

1. Skill - 再利用可能な知識、Progressive Disclosure可能
2. Agent - 複雑なタスクの自動化、ワークフロー実行
3. Command - ユーザー向けインタラクティブ操作
4. Rules/Steering - プロジェクト固有の制約・ガイダンス
5. Docs - 上記で表現できない場合のみ最小限に使用

### 判断フロー

新しい知識を追加する
↓
Q: 繰り返し使う知識か？
↓ YES → Skill として実装
↓ NO
↓
Q: 自動実行すべきタスクか？
↓ YES → Agent として実装
↓ NO
↓
Q: ユーザーが手動実行するか？
↓ YES → Command として実装
↓ NO
↓
Q: プロジェクト固有のルールか？
↓ YES → Rules/Steering に記載
↓ NO
↓
最小限のドキュメントとして docs/ に記載
（可能な限り避ける）

## Git コミット規約

- コミットメッセージ形式:
  - 変更内容を簡潔に記述するのみ
  - 追加の署名やフッターは不要
