#!/usr/bin/env zsh
# å¤ã„.zcompdumpãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–¢æ•°

cleanup_zcompdump() {
  local zdotdir="${ZDOTDIR:-$HOME}"
  local old_files

  echo "ğŸ§¹ å¤ã„.zcompdumpãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ã„ã¾ã™..."
  
  # ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®.zcompdumpãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—
  old_files=($zdotdir/.zcompdump*(N))
  
  if [[ ${#old_files} -gt 0 ]]; then
    echo "å‰Šé™¤å¯¾è±¡: ${#old_files}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«"
    for file in $old_files; do
      echo "  - ${file:t}"
    done
    
    echo -n "å‰Šé™¤ã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ [y/N]: "
    read -r response
    
    if [[ "$response" =~ ^[Yy]$ ]]; then
      rm -f $old_files
      echo "âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"
    else
      echo "âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"
    fi
  else
    echo "âœ… ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚ã‚Šã¾ã›ã‚“"
  fi
} 